(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4250],{7679:function(e,t,a){"use strict";var n=a(85893),r=a(67294),s=a(93463),i=a(61668),l=a.n(i),o=a(24011),d=a(86010);let c=(0,o.L)("label",l().Label),u=(0,o.L)("p",l().Description),p=r.forwardRef((e,t)=>(0,n.jsx)("input",{...e,ref:t,className:(0,d.Z)(e.className,l().Input)}));p.displayName="Input";let m=r.forwardRef(function(e,t){return(0,n.jsx)(s.Z,{...e,ref:t,className:(0,d.Z)(l().Input,e.className,"resize-none w-full")})}),x=(0,o.L)("fieldset",l().Element),h=(0,r.forwardRef)(function(e,t){let{suppressed:a,disabled:r,...s}=e;return(0,n.jsx)(x,{ref:t,...s,className:(0,d.Z)(s.className,a?l().suppressed:"",r?l().disabled:"")})});h.Input=p,h.Label=c,h.Description=u,h.AutoResizeTextArea=m,t.Z=h},75903:function(e,t,a){"use strict";a.d(t,{RT:function(){return g},hz:function(){return j},mz:function(){return k}});var n=a(85893),r=a(92323),s=a(81810),i=a(67294),l=a(85604),o=a(7679),d=a(38372),c=a(1604),u=a(70385),p=a(96897),m=a(62363),x=a(49296),h=a(32478),f=a(20417),v=a(63518),y=a(11163);let g=c.z.array(c.z.object({email:c.z.string().email().optional(),name:c.z.string(),image:c.z.string().optional(),role:c.z.nativeEnum(u.CanvasRolesEnum),isPending:c.z.boolean().default(!1).optional(),id:c.z.string().optional()}));function b(){(0,v.K)("pai:collab:access:request-refresh")}function j(e){let{setModalContent:t}=(0,r.d)(),a=(0,d.Z)(),i=(0,s.R5)(),l=null!=e?e:i;return((0,f.PH)(null!=l?l:void 0),a&&l)?()=>{(0,v.K)("pai:collab:share:opened"),t((0,n.jsx)(N,{id:l}),{transitionModal:!0,showCloseButton:!1})}:null}function N(e){var t,a;let{id:c}=e,u=(0,s.op)(c),[m,x]=i.useState(""),v=(0,d.Z)(),g=(0,y.useRouter)(),{data:j,mutate:N,error:C}=(0,f.PH)(c),{closeModal:k}=(0,r.d)(),R=i.useCallback(async()=>{if(!m)return;let e={email:m,role:"EDITOR",name:m};x("");let t=[...null!=j?j:[],e];N(async()=>{try{var a;let t=await fetch("/api/canvas/share",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({...e,id:null===(a=u.data)||void 0===a?void 0:a.id})});if(200!==t.status)return l.mv.error("Failed to share canvas with ".concat(m)),j;l.mv.success("Shared canvas with ".concat(m)),b()}catch(e){l.mv.error("Failed to share canvas with ".concat(m))}return t},{optimisticData:t})},[j,m,N,null===(t=u.data)||void 0===t?void 0:t.id]),_=e=>{if(!e)return;let t=null==j?void 0:j.filter(t=>t.email!==e);N(async()=>{let a=await (0,p.wX)(()=>{var t;return fetch("/api/canvas/share",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:null===(t=u.data)||void 0===t?void 0:t.id,email:e})})});if((0,p.dZ)(a)||200!==a.status)return console.error(a),l.mv.error("Failed to remove ".concat(e," from canvas")),j;if(e===(null==v?void 0:v.email)){var n,r;k(),l.mv.success('Left "'.concat(null!==(r=null===(n=u.data)||void 0===n?void 0:n.name)&&void 0!==r?r:"Canvas",'"')),g.push("/canvas/files")}else b();return t},{optimisticData:t})},S=(0,f.nZ)();return u?(0,n.jsxs)("div",{"aria-modal":!0,className:"text-white min-w-[572px] bg-gray-90",onKeyDown:e=>{"Escape"!==e.key&&(e.stopPropagation(),e.preventDefault())},onKeyUp:e=>{e.stopPropagation(),e.preventDefault()},children:[(0,n.jsxs)("header",{className:"px-8 py-5 flex justify-between items-center",children:[(0,n.jsxs)("h2",{className:"text-gray-5 font-pg-medium",children:['Share "',null===(a=u.data)||void 0===a?void 0:a.name,'"']}),(0,n.jsx)("button",{className:"text-gray-50 -mr-1",onClick:k,children:(0,n.jsx)(h.Z,{})})]}),(0,n.jsxs)("main",{className:"",children:[(0,n.jsx)("form",{className:"border-y border-gray-85 py-5 px-8",onSubmit:e=>{e.preventDefault(),R()},children:(0,n.jsxs)(o.Z,{className:"flex gap-2",children:[(0,n.jsx)(o.Z.Input,{id:"share-email-input",type:"email",placeholder:"Add editors using email",autoFocus:!0,style:{paddingTop:"8px",paddingBottom:"8px",borderRadius:"6px"},value:m,onChange:e=>{x(e.target.value)},onKeyDown:e=>{"Escape"!==e.key&&e.stopPropagation()}}),(0,n.jsx)("button",{className:"flex-none px-4 bg-purple-primary1 hover:bg-purple-primary rounded-md text-sm font-pg-medium",type:"submit",children:"Send Invite"})]})}),(0,n.jsxs)("section",{className:"pt-5 px-8",children:[(0,n.jsx)("h4",{className:"font-semibold text-sm text-gray-10",children:"People with edit access"}),(0,n.jsxs)("ul",{className:"space-y-4 max-h-64 overflow-auto pt-3 mt-1 pb-5",children:[C&&(0,n.jsx)("li",{className:"border-dark-pink border p-2 px-4 bg-dark-pink/10 rounded-md",children:(0,n.jsxs)("details",{children:[(0,n.jsx)("summary",{children:"An error occurred while loading collaborators"}),(0,n.jsx)("p",{className:"text-sm text-gray-50 font-mono max-w-sm pt-2",children:C.toString()})]})}),(null!=j?j:[]).map(e=>{let t=e.email===(null==v?void 0:v.email),a=e.image?"img":"div",r="OWNER"===e.role;return(0,n.jsxs)("li",{className:"flex gap-2 items-center",children:[(0,n.jsx)(a,{src:e.image,alt:"",className:"w-9 h-9 rounded-full bg-gray-85"}),(0,n.jsxs)("div",{className:"font-pg-medium ",children:[(0,n.jsxs)("p",{className:"text-sm text-gray-10",children:[e.name," ",t?(0,n.jsx)("span",{className:"text-gray-50",children:"(you)"}):""]}),(0,n.jsx)("p",{className:"text-sm text-gray-50",children:e.email})]}),!r&&e.email&&("OWNER"===S||t)&&(0,n.jsx)("div",{className:"ml-auto text-purple-primary text-sm font-pg-medium",children:(0,n.jsx)("button",{onClick:()=>e.email&&_(e.email),className:"pl-2",children:t?"Leave":"Remove"})})]},e.email)})]})]})]}),(0,n.jsxs)("footer",{className:"px-8 pt-4 pb-8 border-t border-gray-85 space-y-4",children:[(0,n.jsx)("h4",{className:"font-semibold text-sm text-gray-10",children:"General access"}),(0,n.jsx)(w,{id:c})]})]}):null}function w(e){var t;let{id:a}=e,r=(0,s.op)(a),[o,d]=(0,i.useState)(!1),c=async e=>{var t;if(!r.data)return;let a=e?"PUBLIC":"PRIVATE";r.mutate(e=>e?(e.type=a,{...e}):e,!1),(await k(null===(t=r.data)||void 0===t?void 0:t.id,{type:a})).ok||l.mv.error({header:"Couldn't update canvas publicity",body:"Please try again later"}),b(),r.mutate()},u=(null===(t=r.data)||void 0===t?void 0:t.type)==="PUBLIC",p=(0,i.useRef)(null);return(0,x.p)(p,()=>{d(!1)}),(0,n.jsxs)("section",{className:"flex items-center justify-between ",children:[(0,n.jsxs)("div",{ref:p,className:"flex gap-3 relative",children:[o&&(0,n.jsxs)("div",{style:{boxShadow:"0px 8px 40px rgba(5, 2, 14, 0.6)"},className:"absolute left-8 -top-3 bg-gray-90 border-gray-85 rounded-lg border font-pg-medium text-gray-25 w-44 text-sm z-50 p-1",children:[(0,n.jsx)(C,{onClick:()=>{c(!1),d(!1)},children:"Restricted"}),(0,n.jsx)(C,{onClick:()=>{c(!0),d(!1)},children:"Anyone with the link"})]}),(0,n.jsx)("div",{className:" w-9 h-9 bg-purple-primary1/30 text-purple-l1 flex items-center justify-center rounded-full",children:u?(0,n.jsx)(m.Sl,{}):(0,n.jsx)(m.HE,{})}),(0,n.jsxs)("button",{className:"font-pg-medium",onClick:()=>d(e=>!e),children:[(0,n.jsxs)("h4",{className:"text-sm text-gray-10 flex gap-1",children:[u?"Anyone with the link":"Restricted",(0,n.jsx)("span",{className:"text-gray-50 translate-y-0.5",children:(0,n.jsx)(m._M,{})})]}),(0,n.jsx)("p",{className:"text-sm text-gray-50",children:u?"Anyone with the link can view the file":"Only editors can open the link to the file"})]})]}),(0,n.jsx)("button",{onClick:()=>{var e;if(!r.data)return;let t=(0,s.cp)(null===(e=r.data)||void 0===e?void 0:e.name,a,!0);navigator.clipboard.writeText(t),l.mv.success("Link copied to clipboard")},className:"px-4 bg-purple-primary1 hover:bg-purple-primary rounded-md text-sm font-pg-medium py-2",children:"Copy Link"})]})}function C(e){return(0,n.jsx)("button",{...e,className:"w-full flex px-3 py-1.5 hover:bg-gray-80 rounded-sm"})}function k(e,t){return fetch("/api/canvas/meta?id="+e,{headers:{"Content-Type":"application/json"},method:"PATCH",body:JSON.stringify(t)})}t.ZP=function(){let e=j(),t=(0,f.RN)();return((0,v.Z)("pai:collab:share:open",()=>{null==e||e()}),t&&e)?(0,n.jsx)("button",{onClick:e,type:"button",className:"bg-purple-primary1 hover:bg-purple-primary w-[69px] py-1.5 rounded-md font-pg-medium text-sm text-gray-5",children:"Share"}):null}},12238:function(e,t,a){"use strict";a.d(t,{Z:function(){return r}});var n=a(85893);function r(e){let{size:t=24,strokeWidth:a=1.35}=e;return(0,n.jsx)("svg",{width:t,height:t,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,n.jsx)("path",{d:"M12 18.75C15.866 18.75 19.25 16.6552 19.25 12C19.25 7.34483 15.866 5.25 12 5.25C8.13401 5.25 4.75 7.34483 4.75 12C4.75 13.7675 5.23783 15.1659 6.05464 16.2206C6.29358 16.5292 6.38851 16.9392 6.2231 17.2926C6.12235 17.5079 6.01633 17.7134 5.90792 17.9082C4.94614 19.6364 5 20 6.99526 19.7297C8.0113 19.5263 9.14752 19.222 10.0954 18.7738C10.2933 18.6803 10.5134 18.6439 10.7305 18.6714C11.145 18.724 11.5695 18.75 12 18.75Z",stroke:"currentColor",strokeWidth:a,strokeLinecap:"round",strokeLinejoin:"round"})})}},20417:function(e,t,a){"use strict";a.d(t,{PH:function(){return l},RN:function(){return d},nZ:function(){return o}});var n=a(75903),r=a(81810),s=a(59820),i=a(38372);function l(e){let t=(0,r.R5)(),a=null!=e?e:t;return(0,s.ZP)(["/api/canvas/getACL",a],async e=>{let[t]=e,r=await fetch(t,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:a})}),s=await r.json(),i=n.RT.safeParse(s);if(i.success)return i.data;{var l,o;console.log(s),console.error(s,i.error);let e=Error(null!==(l=s.error)&&void 0!==l?l:"Unknown error");throw e.code=null!==(o=r.status)&&void 0!==o?o:500,e}},{fallbackData:[]})}function o(e){var t,a;let{data:n,error:r}=l(e),s=(0,i.Z)();return(null==r?void 0:r.code)!==401&&s&&null!==(a=null==n?void 0:null===(t=n.find(e=>e.email===s.email))||void 0===t?void 0:t.role)&&void 0!==a?a:null}function d(){var e;let t=(0,r.R5)();return["OWNER","EDITOR"].includes(null!==(e=o(null!=t?t:void 0))&&void 0!==e?e:"")}},61668:function(e){e.exports={Input:"Setting_Input__vuzz8",Label:"Setting_Label__Uiq_L",Description:"Setting_Description__yEqcC",Element:"Setting_Element__GHX3q",suppressed:"Setting_suppressed__MhBZn",disabled:"Setting_disabled__QSXKJ"}}}]);